@using Starbender.RecipeApp.Blazor.Components.Button

@inherits RecipeComponentBase

<MudPaper Class="pa-3">
    <MudStack Row="true" AlignItems="AlignItems.Center" Justify="Justify.SpaceBetween">
        <MudText Typo="Typo.h6">Recipes</MudText>
        <MudStack Row="true" AlignItems="AlignItems.Center" Spacing="1">
            
            @if (_options.EnableSeeding)
            {
                <SeedButton />
            }

            <CreateRecipeButton HandleDialogSavedAsync="HandleDialogSavedAsync" />
            
            @if(CanCollapse)
            {
                <MudIconButton 
                    Icon="@(_isExpanded ? Icons.Material.Filled.ExpandLess : Icons.Material.Filled.ExpandMore)"
                    Color="Color.Default"
                    Size="Size.Small"
                    OnClick="ToggleExpanded"
                    aria-label="Toggle recipes" />
            }

        </MudStack>
    </MudStack>

    <MudCollapse Expanded=@(!CanCollapse || _isExpanded)>
        <MudTextField T="string"
                      Label="Search recipes"
                      Placeholder="Search title or description"
                      Variant="Variant.Outlined"
                      Margin="Margin.Dense"
                      Immediate="true"
                      @bind-Value="_searchTerm" />

    @foreach(var recipe in FilteredRecipes)
    {
        <RecipeItem Recipe="@recipe" 
            OnDelete="HandleDeleteAsync" 
            OnClick="HandleEditAsync" 
            IsEditable="IsEditable"/>            
    }

    </MudCollapse>
</MudPaper>
